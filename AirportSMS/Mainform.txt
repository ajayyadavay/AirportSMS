public Panel CreateSPICard(FlowLayoutPanel flowLayoutPanel1, string spiName, string spiID, string spiValue)
{
    Panel card = new Panel();
    card.Width = 195;
    card.Height = 150;
    card.Margin = new Padding(12);
    card.Padding = new Padding(15);
    card.BackColor = Color.White;
    card.Cursor = Cursors.Hand;


    // STORE DATA (for detail form)
    card.Tag = new { Name = spiName, ID = spiID, Value = spiValue };

    // --------- CONTENT LAYOUT (FULL BI STYLE) ---------

    // NAME (top)
    Label lblName = new Label();
    lblName.Text = spiName;
    lblName.Font = new Font("Segoe UI Semibold", 12);
    lblName.ForeColor = Color.FromArgb(45, 45, 45);
    lblName.AutoSize = false;
    lblName.Width = card.Width - 30;
    lblName.TextAlign = ContentAlignment.MiddleLeft;
    lblName.Dock = DockStyle.Top;
    lblName.Height = 25;

    // VALUE (CENTER, BIG LIKE BI)
    Label lblValue = new Label();
    lblValue.Text = spiValue;
    lblValue.Font = new Font("Segoe UI", 20, FontStyle.Bold);
    lblValue.ForeColor = Color.FromArgb(0, 90, 158);
    lblValue.AutoSize = false;
    lblValue.Dock = DockStyle.Top;
    lblValue.Height = 45;
    lblValue.TextAlign = ContentAlignment.MiddleLeft;
    lblValue.Padding = new Padding(0, 5, 0, 5);

    // ID (bottom info)
    Label lblID = new Label();
    lblID.Text = $"ID: {spiID}";
    lblID.Font = new Font("Segoe UI", 9);
    lblID.ForeColor = Color.FromArgb(120, 120, 120);
    lblID.AutoSize = false;
    lblID.Dock = DockStyle.Top;
    lblID.Height = 20;

    // DELETE BUTTON (small and elegant)
    Button btnDelete = new Button();
    btnDelete.Text = "×";
    btnDelete.Font = new Font("Segoe UI", 12, FontStyle.Bold);
    btnDelete.ForeColor = Color.White;
    btnDelete.BackColor = Color.FromArgb(200, 60, 70);
    btnDelete.FlatStyle = FlatStyle.Flat;
    btnDelete.FlatAppearance.BorderSize = 0;
    btnDelete.Size = new Size(28, 28);
    btnDelete.Location = new Point(card.Width - 40, 10);
    btnDelete.Cursor = Cursors.Hand;


    btnDelete.Click += (s, e) =>
    {
        if (MessageBox.Show("Delete this SPI?", "Confirm", MessageBoxButtons.YesNo) == DialogResult.Yes)
        {
            flowLayoutPanel1.Controls.Remove(card);
            card.Dispose();
        }
    };

    // Card click → open detail form
    void openDetails(object s, EventArgs e)
    {
        var info = (dynamic)card.Tag;
        OpenDetailForm(info.Name, info.ID, info.Value);
    }

    card.Click += openDetails;
    lblName.Click += openDetails;
    lblValue.Click += openDetails;
    lblID.Click += openDetails;

    // Add content
    card.Controls.Add(btnDelete);
    //MessageBox.Show("step 2");
    card.Controls.Add(lblID);
    card.Controls.Add(lblValue);
    card.Controls.Add(lblName);

    return card;
}